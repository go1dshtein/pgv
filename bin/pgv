#!/usr/bin/env python2.7
import os
import logging
import pgv.config
import pgv.utils
import pgv.argparser
import pgv.app


def main():
    try:
        #logging.basicConfig(format="%(message)s", level="INFO")
        #logger = logging
        options = pgv.argparser.parse()
        config = pgv.config.parse(pgv.utils.search_config(options.config))
        pgv.utils.setup_logging(config.logging)
        logger = logging.getLogger(__name__)
        pgv.app.Application(config, options).run(options.command)
    except Exception, e:
        logger.exception(e)
        os._exit(1)

if __name__ == '__main__':
    main()
